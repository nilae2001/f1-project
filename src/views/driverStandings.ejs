<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Driver Standings</title>
    <script src="https://kit.fontawesome.com/58de2f2a64.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <header>
        <nav class="navbar">
          <ul class="menu">
            <li class="dropdown-header">
                <a href="http://localhost:4000"><h1>F1 World</h1></a>
            </li>
            <li class="dropdown">
              <a href="#">Schedule</a>
              <div class="dropdown-content">
                <ul>
                    <% races.forEach(race => { %>
                  <li><a href="#"><%= race.raceName %></a></li>
                    <% }) %>
                </ul>
              </div>
            </li>
            <li class="dropdown">
                <a href="http://localhost:4000/drivers">Drivers</a>
                <div class="dropdown-content">
                  <ul>
                    <% drivers.forEach(driver => { %>
                    <li><a href="#"><%= driver.driverName %> <%= driver.driverFamilyName %></a></li>
                    <% }) %>
                  </ul>
                </div>
              </li>
              <li class="dropdown">
                <a href="#">Teams</a>
                <div class="dropdown-content">
                  <ul>
                    <% teams.forEach(team => { %>
                    <li id="teamsInfo">
                        <a href="#"><%= team.name %></a>
                        <img id="teams-img" src=<%= team.image %> alt="">
                    </li>
                    <% }) %>
                  </ul>
                </div>
              </li>
              <li class="dropdown">
                <a href="http://localhost:4000/driver-standings">Driver Standings</a>
                <div class="dropdown-content">
                  <a href="http://localhost:4000/driver-standings"><h2>See Driver Standings <i class="fa-solid fa-arrow-right"></i></h2></a>
                </div>
              </li>
              <li class="dropdown">
                <a href="#">Constructor Standings</a>
                <div class="dropdown-content">
                  <a href=""><h2>See Constructor Standings <i class="fa-solid fa-arrow-right"></i></h2></a>
                </div>
              </li>
          </ul>
        </nav>
      </header>

      <div class="confetti-container"></div>

      <main>

        <section id="podium">
            <h1>F1 2024 World Drivers Championship Podium</h1>
        
            <div class="podium-container">
                <article class="podium-second">
                    <img src="<%= enrichedStandings[1].image %>" alt="">
                    <div class="info">
                        <h3><%= enrichedStandings[1].Driver.givenName %> <%= enrichedStandings[1].Driver.familyName %></h3>
                        <h4>Position: <%= enrichedStandings[1].position %></h4>
                        <h4>Points: <span class="points-counter" data-points="<%= enrichedStandings[1].points %>">0</span></h4>
                    </div>
                </article>
        
                <article class="podium-first">
                    <img src="<%= enrichedStandings[0].image %>" alt="">
                    <div class="info">
                        <h3><%= enrichedStandings[0].Driver.givenName %> <%= enrichedStandings[0].Driver.familyName %></h3>
                        <h4>Position: <%= enrichedStandings[0].position %></h4>
                        <h4>Points: <span class="points-counter" data-points="<%= enrichedStandings[0].points %>">0</span></h4>
                    </div>
                </article>
        
                <article class="podium-third">
                    <img src="<%= enrichedStandings[2].image %>" alt="">
                    <div class="info">
                        <h3><%= enrichedStandings[2].Driver.givenName %> <%= enrichedStandings[2].Driver.familyName %></h3>
                        <h4>Position: <%= enrichedStandings[2].position %></h4>
                        <h4>Points: <span class="points-counter" data-points="<%= enrichedStandings[2].points %>">0</span></h4>
                    </div>
                </article>
            </div>
        

            <script>
                document.addEventListener("DOMContentLoaded", () => {
                const counters = document.querySelectorAll(".points-counter");

                counters.forEach((counter) => {
                    const targetPoints = parseInt(counter.dataset.points, 10);
                    let currentPoints = 0;
                    const duration = 2000;
                    const increment = Math.ceil(targetPoints / (duration / 16));

                    const countUp = () => {
                        currentPoints += increment;
                        if (currentPoints >= targetPoints) {
                            counter.textContent = targetPoints;
                            
                            generateConfetti();
                        } else {
                            counter.textContent = currentPoints;
                            requestAnimationFrame(countUp);
                        }
                    };

                    countUp();
                });
            });

            
            function generateConfetti() {
                const container = document.querySelector('.confetti-container') || createConfettiContainer();
                
                const colors = ['#ff6347', '#32cd32', '#1e90ff', '#ff1493', '#ffd700', '#4b0082'];

                
                for (let i = 0; i < 100; i++) {
                    const confetti = document.createElement('div');
                    confetti.classList.add('confetti');

                    
                    const randomColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.backgroundColor = randomColor;

                    
                    confetti.style.left = `${Math.random() * 100}vw`; 
                    confetti.style.animationDelay = `${Math.random() * 1}s`; 

                    container.appendChild(confetti);
                }

                
                setTimeout(() => {
                    container.innerHTML = ''; 
                }, 4000); 
            }

            
            function createConfettiContainer() {
                const container = document.createElement('div');
                container.classList.add('confetti-container');
                document.body.appendChild(container);
                return container;
            }

        </script>

      </section>

      <section>
        <div class="table">
        <table>
            
        <caption>F1 2024 Championship Standings</caption>

        <tr>
        <th scope="col">Driver</th>
        <th scope="col">Team</th>
        <th scope="col">Position</th>
        <th scope="col">Points</th>
        <th scope="col">Wins</th>
        </tr>
        
        
        <% driverStandings.forEach(person => { %>
        <tr>
        <td><%= person.Driver.givenName %> <%= person.Driver.familyName %></td>
        
        <td><%= person.Constructors[0].name %></td>

        <td><%= person.position %></td>

        <td><%= person.points %></td>

        <td><%= person.wins %></td>
        </tr>
        <% }) %>
        
    </table>
    </div>
</section>

</main>
</body>
</html>